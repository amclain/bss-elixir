
defmodule SoundwebMessageTest do
  use ExUnit.Case
  
  test "unescape binary" do
    escaped = <<0x88,0x10,0x1B,0x82,0x1B,0x83,0x00,0x01,0x47,0x00,0x00,0x00,
      0x00,0x00,0x00,0xDF>>
      
    unescaped = <<0x88,0x10,0x02,0x03,0x00,0x01,0x47,0x00,0x00,0x00,0x00,
      0x00,0x00,0xDF>>
    
    assert SoundwebMessage.unescape(escaped) === unescaped
  end
  
  test "escape binary" do
    escaped = <<0x88,0x10,0x1B,0x82,0x1B,0x83,0x00,0x01,0x47,0x00,0x00,0x00,
      0x00,0x00,0x00,0xDF>>
      
    unescaped = <<0x88,0x10,0x02,0x03,0x00,0x01,0x47,0x00,0x00,0x00,0x00,
      0x00,0x00,0xDF>>
    
    assert SoundwebMessage.escape(unescaped) === escaped
  end
  
  # test "binary to struct" do
  #   # SETSV
  #   bin = <<0x02,0x88,0x10,0x1B,0x82,0x1B,0x83,0x00,0x01,0x74,0x00,0x00,0x00,
  #     0x00,0x00,0x00,0xDF,0x03>>
    
  #   struct = %{cmd: 0x88, addr: 0x100203000147, sv: 0x0000, data: 0x00000000}
    
  #   assert SoundwebMessage.binary_to_struct(bin) === struct
  # end
  
  # test "tuple to struct" do
  # end
  
end
